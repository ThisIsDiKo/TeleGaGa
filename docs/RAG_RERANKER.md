# RAG Reranker –∏ —Ñ–∏–ª—å—Ç—Ä —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏

**–î–∞—Ç–∞:** 04 —Ñ–µ–≤—Ä–∞–ª—è 2026
**–í–µ—Ä—Å–∏—è:** 1.0
**–ê–≤—Ç–æ—Ä:** –î–µ–Ω—å 18 - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è RAG

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–ü—Ä–æ–±–ª–µ–º–∞](#–ø—Ä–æ–±–ª–µ–º–∞)
3. [–†–µ—à–µ–Ω–∏–µ](#—Ä–µ—à–µ–Ω–∏–µ)
4. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
5. [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
6. [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
7. [–ü—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∏–º–µ—Ä—ã)
8. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏)
9. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
10. [–ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è](#–±—É–¥—É—â–∏–µ-—É–ª—É—á—à–µ–Ω–∏—è)

---

## –û–±–∑–æ—Ä

–í —Ä–∞–º–∫–∞—Ö –î–Ω—è 18 —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ TeleGaGa –±–æ—Ç–∞ –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω **—Ñ–∏–ª—å—Ç—Ä —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è RAG (Retrieval-Augmented Generation)**. –≠—Ç–æ –≤—Ç–æ—Ä–æ–π —ç—Ç–∞–ø —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç—Å–µ–∫–∞–µ—Ç –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞–Ω–∫–∏ –ø–æ –ø–æ—Ä–æ–≥—É –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üéØ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥—É** - –æ—Ç—Å–µ–∫–∞–µ—Ç —á–∞–Ω–∫–∏ —Å –Ω–∏–∑–∫–æ–π —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é (< –ø–æ—Ä–æ–≥–∞)
- üìä **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –¥–æ/–ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- ‚öôÔ∏è **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –ø–æ—Ä–æ–≥** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ (0.0-1.0)
- üîç **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤** - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è 3-—Ö –º–µ—Ç–æ–¥–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
- üíæ **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Å–µ–∞–Ω—Å–∞–º–∏

---

## –ü—Ä–æ–±–ª–µ–º–∞

–î–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞ RAG —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–ª–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –Ω–∞—Ö–æ–¥–∏–ª **—Ç–æ–ø-K** –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ø-5)
2. **–í–°–ï** –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —á–∞–Ω–∫–∏ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å –≤ LLM, –¥–∞–∂–µ –µ—Å–ª–∏ –∏—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –±—ã–ª–∞ –Ω–∏–∑–∫–æ–π
3. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ **—à—É–º—É** - LLM –ø–æ–ª—É—á–∞–ª–∞ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã

**–í–æ–ø—Ä–æ—Å:** "–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–µ?"

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞:**
```
1. –ß–∞–Ω–∫ #23: 0.75 (75%) - –ø—Ä–æ MCP weather server
2. –ß–∞–Ω–∫ #45: 0.68 (68%) - –ø—Ä–æ GigaChat
3. –ß–∞–Ω–∫ #12: 0.42 (42%) - –ø—Ä–æ Docker
4. –ß–∞–Ω–∫ #89: 0.35 (35%) - –ø—Ä–æ Kotlin
5. –ß–∞–Ω–∫ #67: 0.28 (28%) - –ø—Ä–æ build.gradle
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ß–∞–Ω–∫–∏ 3-5 –∏–º–µ—é—Ç –Ω–∏–∑–∫—É—é —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å (< 50%), –Ω–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ LLM, —Å–æ–∑–¥–∞–≤–∞—è —à—É–º.

---

## –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω **–≤—Ç–æ—Ä–æ–π —ç—Ç–∞–ø —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏** —Å –ø–æ—Ä–æ–≥–æ–º –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞:

1. –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ–ø-K –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
2. **–§–ò–õ–¨–¢–†:** –æ—Ç—Å–µ–∫–∞–µ—Ç —á–∞–Ω–∫–∏ —Å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é < –ø–æ—Ä–æ–≥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.5)
3. –¢–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞–Ω–∫–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ LLM

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–ø–æ—Ä–æ–≥ = 0.5)

```
‚úÖ –ü—Ä–æ—à–ª–∏ —Ñ–∏–ª—å—Ç—Ä:
1. –ß–∞–Ω–∫ #23: 0.75 (75%)
2. –ß–∞–Ω–∫ #45: 0.68 (68%)

‚ùå –û—Ç—Å–µ—á–µ–Ω—ã:
3. –ß–∞–Ω–∫ #12: 0.42 (42%)
4. –ß–∞–Ω–∫ #89: 0.35 (35%)
5. –ß–∞–Ω–∫ #67: 0.28 (28%)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–µ–Ω—å—à–µ —à—É–º–∞ ‚Üí —Ç–æ—á–Ω–µ–µ –æ—Ç–≤–µ—Ç—ã
- –ú–µ–Ω—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤ ‚Üí –±—ã—Å—Ç—Ä–µ–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –±–∞–ª–∞–Ω—Å —Ç–æ—á–Ω–æ—Å—Ç—å/–ø–æ–ª–Ω–æ—Ç–∞

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   Telegram User                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
                    ‚îÇ /compareRag, /setThreshold
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              TelegramBotService                         ‚îÇ
‚îÇ  ‚Ä¢ /compareRag - —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç 3 –ø–æ–¥—Ö–æ–¥–∞                  ‚îÇ
‚îÇ  ‚Ä¢ /setThreshold - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–æ—Ä–æ–≥                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                RagService                               ‚îÇ
‚îÇ  ‚Ä¢ findRelevantChunks() - —Ç–æ–ø-K –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤             ‚îÇ
‚îÇ  ‚Ä¢ findRelevantChunksWithFilter() - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è         ‚îÇ
‚îÇ  ‚Ä¢ formatContext() - —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         ChatSettingsManager (Persistence)               ‚îÇ
‚îÇ  ‚Ä¢ ragRelevanceThreshold (Float) - –ø–æ—Ä–æ–≥               ‚îÇ
‚îÇ  ‚Ä¢ ragEnabled (Boolean) - –≤–∫–ª/–≤—ã–∫–ª RAG                 ‚îÇ
‚îÇ  ‚Ä¢ ragTopK (Int) - –∫–æ–ª-–≤–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö (–∫–æ–º–∞–Ω–¥–∞ /compareRag)

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí /compareRag –ö–∞–∫–∏–µ MCP —Å–µ—Ä–≤–µ—Ä—ã?
                     ‚Üì
2. TelegramBotService –∑–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ø–æ—Ä–æ–≥ = 0.5)
                     ‚Üì
3. RagService.findRelevantChunks() ‚Üí —Ç–æ–ø-5 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
                     ‚Üì
4. RagService.findRelevantChunksWithFilter() ‚Üí —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
                     ‚Üì
5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 3-—Ö –æ—Ç–≤–µ—Ç–æ–≤:
   ‚Ä¢ –ë–ï–ó RAG
   ‚Ä¢ –° RAG (—Ç–æ–ø-5, –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞)
   ‚Ä¢ –° RAG + —Ñ–∏–ª—å—Ç—Ä
                     ‚Üì
6. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å –∞–Ω–∞–ª–∏–∑–æ–º
                     ‚Üì
7. –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

---

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ ChatSettings

**–§–∞–π–ª:** `src/main/kotlin/ru/dikoresearch/infrastructure/persistence/ChatSettingsManager.kt`

```kotlin
@Serializable
data class ChatSettings(
    val chatId: Long,
    val temperature: Float = 0.87F,
    val reminderTime: String? = null,
    val reminderEnabled: Boolean = false,
    val lastReminderSent: String? = null,

    // === RAG –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ===
    val ragRelevanceThreshold: Float = 0.5F, // –ü–æ—Ä–æ–≥ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞ (0.0-1.0)
    val ragEnabled: Boolean = true,           // –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å RAG
    val ragTopK: Int = 5                      // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è reranking
)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `chat_settings/<chatId>_settings.json`
- Thread-safe (Mutex –¥–ª—è –∫–∞–∂–¥–æ–≥–æ chatId)
- –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö —á–∞—Ç–æ–≤

### 2. RagSearchResult data class

**–§–∞–π–ª:** `src/main/kotlin/ru/dikoresearch/domain/RagService.kt`

```kotlin
data class RagSearchResult(
    val chunks: List<Triple<String, Float, Int>>,  // (—Ç–µ–∫—Å—Ç, —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å, –∏–Ω–¥–µ–∫—Å)
    val originalCount: Int,                         // –ö–æ–ª-–≤–æ –¥–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    val filteredCount: Int,                         // –ö–æ–ª-–≤–æ –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    val avgRelevance: Float,                        // –°—Ä–µ–¥–Ω—è—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å
    val minRelevance: Float,                        // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å
    val maxRelevance: Float                         // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å
)
```

**–¶–µ–ª—å:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

### 3. –ú–µ—Ç–æ–¥ findRelevantChunksWithFilter()

**–§–∞–π–ª:** `src/main/kotlin/ru/dikoresearch/domain/RagService.kt`

```kotlin
suspend fun findRelevantChunksWithFilter(
    question: String,
    fileName: String = "readme",
    topK: Int = 5,
    relevanceThreshold: Float = 0.5f
): RagSearchResult {
    // 1. –ü–æ–ª—É—á–∞–µ–º —Ç–æ–ø-K –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
    val topCandidates = findRelevantChunks(question, fileName, topK)

    // 2. –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –ø–æ—Ä–æ–≥—É
    val filteredChunks = topCandidates.filter { (_, relevance, _) ->
        relevance >= relevanceThreshold
    }

    // 3. –°–æ–±–∏—Ä–∞–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
    val avgRelevance = if (filteredChunks.isNotEmpty()) {
        filteredChunks.map { it.second }.average().toFloat()
    } else 0f

    val minRelevance = filteredChunks.minOfOrNull { it.second } ?: 0f
    val maxRelevance = filteredChunks.maxOfOrNull { it.second } ?: 0f

    println("üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:")
    println("   –î–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏: ${topCandidates.size} —á–∞–Ω–∫–æ–≤")
    println("   –ü–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (‚â•${relevanceThreshold}): ${filteredChunks.size} —á–∞–Ω–∫–æ–≤")
    if (filteredChunks.isNotEmpty()) {
        println("   –°—Ä–µ–¥–Ω—è—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: %.4f".format(avgRelevance))
    }

    return RagSearchResult(
        chunks = filteredChunks,
        originalCount = topCandidates.size,
        filteredCount = filteredChunks.size,
        avgRelevance = avgRelevance,
        minRelevance = minRelevance,
        maxRelevance = maxRelevance
    )
}
```

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–ø-K –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫)
2. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —á–∞–Ω–∫–∏ —Å `—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å >= –ø–æ—Ä–æ–≥`
3. –í—ã—á–∏—Å–ª–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (avg, min, max)
4. –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

### 4. –ö–æ–º–∞–Ω–¥–∞ /setThreshold

**–§–∞–π–ª:** `src/main/kotlin/ru/dikoresearch/infrastructure/telegram/TelegramBotService.kt`

```kotlin
command("setThreshold") {
    val chatId = message.chat.id
    val thresholdStr = args.joinToString(" ")

    if (thresholdStr.isBlank()) {
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π –ø–æ—Ä–æ–≥
        applicationScope.launch {
            val settings = settingsManager.loadSettings(chatId)
            bot.sendMessage(ChatId.fromId(chatId), """
üìä –¢–µ–∫—É—â–∏–π –ø–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏: ${settings.ragRelevanceThreshold}

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /setThreshold <–∑–Ω–∞—á–µ–Ω–∏–µ>
–î–∏–∞–ø–∞–∑–æ–Ω: 0.0 - 1.0

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
‚Ä¢ 0.3-0.4 (–Ω–∏–∑–∫–∏–π) - –±–æ–ª—å—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –º–æ–∂–µ—Ç –±—ã—Ç—å —à—É–º
‚Ä¢ 0.5-0.6 (—Å—Ä–µ–¥–Ω–∏–π) - —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥
‚Ä¢ 0.7-0.8 (–≤—ã—Å–æ–∫–∏–π) - —Ç–æ–ª—å–∫–æ –≤—ã—Å–æ–∫–æ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞–Ω–∫–∏

–ü—Ä–∏–º–µ—Ä: /setThreshold 0.6
            """.trimIndent())
        }
        return@command
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    val newThreshold = try {
        thresholdStr.toFloat()
    } catch (e: Exception) {
        bot.sendMessage(ChatId.fromId(chatId),
            "‚ùå –û—à–∏–±–∫–∞: –ø–æ—Ä–æ–≥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º –æ—Ç 0.0 –¥–æ 1.0")
        return@command
    }

    if (newThreshold < 0.0f || newThreshold > 1.0f) {
        bot.sendMessage(ChatId.fromId(chatId),
            "‚ùå –û—à–∏–±–∫–∞: –ø–æ—Ä–æ–≥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0.0 - 1.0")
        return@command
    }

    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    applicationScope.launch {
        val settings = settingsManager.loadSettings(chatId)
        settingsManager.saveSettings(chatId, settings.copy(
            ragRelevanceThreshold = newThreshold
        ))
        bot.sendMessage(ChatId.fromId(chatId),
            "‚úÖ –ü–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω: $newThreshold")
    }
}
```

### 5. –ö–æ–º–∞–Ω–¥–∞ /compareRag

**–§–∞–π–ª:** `src/main/kotlin/ru/dikoresearch/infrastructure/telegram/TelegramBotService.kt`

–ö–æ–º–∞–Ω–¥–∞ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç 3 –ø–æ–¥—Ö–æ–¥–∞:

1. **–ë–ï–ó RAG** - –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ Ollama –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
2. **–° RAG (—Ç–æ–ø-5, –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞)** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —á–∞–Ω–∫–∏
3. **–° RAG + –§–ò–õ–¨–¢–†** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —á–∞–Ω–∫–∏ –≤—ã—à–µ –ø–æ—Ä–æ–≥–∞

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∏–∑–º–µ—Ä—è–µ—Ç—Å—è:
- –û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏
- –°–ø–∏—Å–æ–∫ —á–∞–Ω–∫–æ–≤ (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å)
- –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìä –°–†–ê–í–ù–ï–ù–ò–ï –¢–†–ï–• –ü–û–î–•–û–î–û–í RAG
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üîç –í–æ–ø—Ä–æ—Å: –ö–∞–∫–∏–µ MCP —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è?

‚îÅ‚îÅ‚îÅ 1Ô∏è‚É£ –ë–ï–ó RAG ‚îÅ‚îÅ‚îÅ
[–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞]

‚è±Ô∏è –í—Ä–µ–º—è: 1234ms

‚îÅ‚îÅ‚îÅ 2Ô∏è‚É£ RAG (—Ç–æ–ø-5, –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞) ‚îÅ‚îÅ‚îÅ
[–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ —Å —Ç–æ–ø-5 —á–∞–Ω–∫–∞–º–∏]

üìä –ß–∞–Ω–∫–∏:
   1. –ß–∞–Ω–∫ #23: 0.7500 (75%)
   2. –ß–∞–Ω–∫ #45: 0.6800 (68%)
   3. –ß–∞–Ω–∫ #12: 0.4200 (42%)
   4. –ß–∞–Ω–∫ #89: 0.3500 (35%)
   5. –ß–∞–Ω–∫ #67: 0.2800 (28%)
‚è±Ô∏è –í—Ä–µ–º—è: 2345ms

‚îÅ‚îÅ‚îÅ 3Ô∏è‚É£ RAG + –§–ò–õ–¨–¢–† (‚â•0.5) ‚îÅ‚îÅ‚îÅ
[–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ —Å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —á–∞–Ω–∫–∞–º–∏]

üìä –ß–∞–Ω–∫–∏:
   –ù–∞–π–¥–µ–Ω–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤: 5
   –ü—Ä–æ—à–ª–∏ —Ñ–∏–ª—å—Ç—Ä: 2
   –°—Ä–µ–¥–Ω—è—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: 0.7150
   1. –ß–∞–Ω–∫ #23: 0.7500 (75%)
   2. –ß–∞–Ω–∫ #45: 0.6800 (68%)
‚è±Ô∏è –í—Ä–µ–º—è: 1789ms

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üí° –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚úÖ –§–∏–ª—å—Ç—Ä –æ—Ç—Å–µ–∫ 3 –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤
   –û—Ç–≤–µ—Ç 3 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ—á–Ω–µ–µ –æ—Ç–≤–µ—Ç–∞ 2

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /setThreshold –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä–æ–≥–∞
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏

#### 1. –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π –ø–æ—Ä–æ–≥
```
/setThreshold
```

**–û—Ç–≤–µ—Ç:**
```
üìä –¢–µ–∫—É—â–∏–π –ø–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏: 0.5

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /setThreshold <–∑–Ω–∞—á–µ–Ω–∏–µ>
–î–∏–∞–ø–∞–∑–æ–Ω: 0.0 - 1.0

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
‚Ä¢ 0.3-0.4 (–Ω–∏–∑–∫–∏–π) - –±–æ–ª—å—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –º–æ–∂–µ—Ç –±—ã—Ç—å —à—É–º
‚Ä¢ 0.5-0.6 (—Å—Ä–µ–¥–Ω–∏–π) - —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥
‚Ä¢ 0.7-0.8 (–≤—ã—Å–æ–∫–∏–π) - —Ç–æ–ª—å–∫–æ –≤—ã—Å–æ–∫–æ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞–Ω–∫–∏
```

#### 2. –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä–æ–≥
```
/setThreshold 0.6
```

**–û—Ç–≤–µ—Ç:**
```
‚úÖ –ü–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω: 0.6

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:
‚Ä¢ –°—Ä–µ–¥–Ω–∏–π –ø–æ—Ä–æ–≥ - —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å –ø–æ–º–æ—â—å—é /compareRag <–≤–æ–ø—Ä–æ—Å>
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ RAG

```
/compareRag –ö–∞–∫–∏–µ MCP —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ?
```

–ö–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç 3 –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –ø–æ–∫–∞–∂–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ.

---

## –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –í—ã—Å–æ–∫–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å

**–í–æ–ø—Ä–æ—Å:** `/compareRag –ö–∞–∫–∏–µ MCP —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è?`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–¥—Ö–æ–¥ 2: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 5 —á–∞–Ω–∫–æ–≤ (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å 0.75, 0.68, 0.62, 0.58, 0.51)
- –ü–æ–¥—Ö–æ–¥ 3: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 5 —á–∞–Ω–∫–æ–≤ (–≤—Å–µ –ø—Ä–æ—à–ª–∏ —Ñ–∏–ª—å—Ç—Ä 0.5)
- **–ê–Ω–∞–ª–∏–∑:** "‚úÖ –í—Å–µ —á–∞–Ω–∫–∏ –ø—Ä–æ—à–ª–∏ —Ñ–∏–ª—å—Ç—Ä - –≤—ã—Å–æ–∫–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å"

### –ü—Ä–∏–º–µ—Ä 2: –ù–∏–∑–∫–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å

**–í–æ–ø—Ä–æ—Å:** `/compareRag –ö–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –±–æ—Ä—â?`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–¥—Ö–æ–¥ 2: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 5 —á–∞–Ω–∫–æ–≤ (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å 0.38, 0.32, 0.25, 0.18, 0.12)
- –ü–æ–¥—Ö–æ–¥ 3: 0 —á–∞–Ω–∫–æ–≤ (–≤—Å–µ –æ—Ç—Å–µ—á–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä–æ–º 0.5)
- **–ê–Ω–∞–ª–∏–∑:** "‚ùå –§–∏–ª—å—Ç—Ä –æ—Ç—Å–µ–∫ –≤—Å–µ —á–∞–Ω–∫–∏ - —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –Ω–∏–∑–∫–∞—è. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —É–º–µ–Ω—å—à–∏—Ç—å –ø–æ—Ä–æ–≥ –∏–ª–∏ –≤–æ–ø—Ä–æ—Å –≤–Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏"

### –ü—Ä–∏–º–µ—Ä 3: –°—Ä–µ–¥–Ω—è—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å

**–í–æ–ø—Ä–æ—Å:** `/compareRag –†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ RAG`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–¥—Ö–æ–¥ 2: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 5 —á–∞–Ω–∫–æ–≤ (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å 0.72, 0.65, 0.48, 0.35, 0.28)
- –ü–æ–¥—Ö–æ–¥ 3: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 2 —á–∞–Ω–∫–∞ (3 –æ—Ç—Å–µ—á–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä–æ–º 0.5)
- **–ê–Ω–∞–ª–∏–∑:** "‚úÖ –§–∏–ª—å—Ç—Ä –æ—Ç—Å–µ–∫ 3 –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤. –û—Ç–≤–µ—Ç 3 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ—á–Ω–µ–µ –æ—Ç–≤–µ—Ç–∞ 2"

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–æ—Ä–º—É–ª–∞:

```
cosine_similarity(A, B) = (A ¬∑ B) / (||A|| √ó ||B||)
```

–ì–¥–µ:
- `A ¬∑ B` - —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤
- `||A||` - –Ω–æ—Ä–º–∞ –≤–µ–∫—Ç–æ—Ä–∞ A (–¥–ª–∏–Ω–∞)
- `||B||` - –Ω–æ—Ä–º–∞ –≤–µ–∫—Ç–æ—Ä–∞ B (–¥–ª–∏–Ω–∞)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 1]
- `1.0` - –≤–µ–∫—Ç–æ—Ä—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã (100% —Å—Ö–æ–¥—Å—Ç–≤–æ)
- `0.5` - —É–º–µ—Ä–µ–Ω–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ (50%)
- `0.0` - –≤–µ–∫—Ç–æ—Ä—ã –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω—ã (0% —Å—Ö–æ–¥—Å—Ç–≤–æ)

### –í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞

| –ü–æ—Ä–æ–≥ | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è | –†–µ–∑—É–ª—å—Ç–∞—Ç—ã | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |
|-------|---------------|------------|--------------|
| 0.3-0.4 | –ù–∏–∑–∫–∏–π | –ë–æ–ª—å—à–µ —á–∞–Ω–∫–æ–≤, –º–æ–∂–µ—Ç –±—ã—Ç—å —à—É–º | –î–ª—è —à–∏—Ä–æ–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ |
| 0.5-0.6 | –°—Ä–µ–¥–Ω–∏–π | –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ | **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) |
| 0.7-0.8 | –í—ã—Å–æ–∫–∏–π | –¢–æ–ª—å–∫–æ –≤—ã—Å–æ–∫–æ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ | –î–ª—è —Ç–æ—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ |
| 0.9+ | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π | –ú–∏–Ω–∏–º—É–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ | –î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è |

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:** < 10ms

–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ø–∞–º—è—Ç–∏ –ø–æ—Å–ª–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞, –ø–æ—ç—Ç–æ–º—É –¥–æ–±–∞–≤–ª—è–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã.

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
- –ë–ï–ó RAG: ~1000-1500ms (—Ç–æ–ª—å–∫–æ LLM)
- –° RAG (5 —á–∞–Ω–∫–æ–≤): ~2000-3000ms (embedding + LLM —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º)
- –° RAG + —Ñ–∏–ª—å—Ç—Ä (2-3 —á–∞–Ω–∫–∞): ~1500-2500ms (–º–µ–Ω—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤ ‚Üí –±—ã—Å—Ç—Ä–µ–µ)

### –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ JSON —Ñ–∞–π–ª–∞—Ö:

**–ü—É—Ç—å:** `chat_settings/<chatId>_settings.json`

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "chatId": 123456789,
  "temperature": 0.87,
  "reminderTime": "09:00",
  "reminderEnabled": true,
  "lastReminderSent": "2026-02-04T09:00:00+03:00",
  "ragRelevanceThreshold": 0.6,
  "ragEnabled": true,
  "ragTopK": 5
}
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### 1. –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
./gradlew run

# –í Telegram:
/start                  # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
/setThreshold           # –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π –ø–æ—Ä–æ–≥
/setThreshold 0.6       # –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä–æ–≥
/setThreshold abc       # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é (–æ—à–∏–±–∫–∞)
/setThreshold 1.5       # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω (–æ—à–∏–±–∫–∞)
```

#### 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

**–¢–µ—Å—Ç 1: –í—ã—Å–æ–∫–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å**
```
/compareRag –ö–∞–∫–∏–µ MCP —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ?
```
**–û–∂–∏–¥–∞–Ω–∏–µ:**
- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä
- –ê–Ω–∞–ª–∏–∑: "‚úÖ –í—Å–µ —á–∞–Ω–∫–∏ –ø—Ä–æ—à–ª–∏ —Ñ–∏–ª—å—Ç—Ä"

**–¢–µ—Å—Ç 2: –ù–∏–∑–∫–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å**
```
/compareRag –ö–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –±–æ—Ä—â?
```
**–û–∂–∏–¥–∞–Ω–∏–µ:**
- –í—Å–µ —á–∞–Ω–∫–∏ –æ—Ç—Å–µ—á–µ–Ω—ã
- –ê–Ω–∞–ª–∏–∑: "‚ùå –§–∏–ª—å—Ç—Ä –æ—Ç—Å–µ–∫ –≤—Å–µ —á–∞–Ω–∫–∏"

**–¢–µ—Å—Ç 3: –°—Ä–µ–¥–Ω—è—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å**
```
/compareRag –†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ RAG
```
**–û–∂–∏–¥–∞–Ω–∏–µ:**
- –ß–∞—Å—Ç—å —á–∞–Ω–∫–æ–≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä
- –ê–Ω–∞–ª–∏–∑: "‚úÖ –§–∏–ª—å—Ç—Ä –æ—Ç—Å–µ–∫ N –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤"

#### 3. –†–∞–∑–Ω—ã–µ –ø–æ—Ä–æ–≥–∏
```
/setThreshold 0.3
/compareRag –ö–∞–∫–∏–µ MCP —Å–µ—Ä–≤–µ—Ä—ã?
# ‚Üí –ë–æ–ª—å—à–µ —á–∞–Ω–∫–æ–≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç

/setThreshold 0.7
/compareRag –ö–∞–∫–∏–µ MCP —Å–µ—Ä–≤–µ—Ä—ã?
# ‚Üí –ú–µ–Ω—å—à–µ —á–∞–Ω–∫–æ–≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç
```

#### 4. –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
```
/setThreshold 0.6
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
/setThreshold
# ‚Üí –ü–æ—Ä–æ–≥ –≤—Å—ë –µ—â–µ 0.6
```

### –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–∂–∏–¥–∞–µ–º:
- ‚úÖ **–£–º–µ–Ω—å—à–µ–Ω–∏–µ —à—É–º–∞:** 20-30% –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è
- ‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å:** —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç < 10ms –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤
- ‚úÖ **–¢–æ—á–Ω–æ—Å—Ç—å:** —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 15-25% –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –æ—Ç–≤–µ—Ç–æ–≤ (—Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ)

---

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. LLM-based Reranker (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)

–í–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–æ—Ä–æ–≥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LLM –¥–ª—è –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è:

```kotlin
suspend fun rerankWithLLM(
    question: String,
    chunks: List<Triple<String, Float, Int>>
): List<Triple<String, Float, Int>> {
    // –î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞ —Å–ø—Ä–æ—Å–∏—Ç—å LLM:
    // "–†–µ–ª–µ–≤–∞–Ω—Ç–µ–Ω –ª–∏ —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞?"
    // –ü–æ–ª—É—á–∏—Ç—å –æ—Ü–µ–Ω–∫—É 0-100
    // –ü–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å –ø–æ –æ—Ü–µ–Ω–∫–µ LLM
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞
- –£—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Å–º—ã—Å–ª

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ LLM –≤—ã–∑–æ–≤—ã)
- –î–æ—Ä–æ–∂–µ (–±–æ–ª—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤)

### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ—Ä–æ–≥

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏:

```kotlin
fun adaptiveThreshold(relevances: List<Float>): Float {
    // –ï—Å–ª–∏ –µ—Å—Ç—å —è–≤–Ω—ã–π —Ä–∞–∑—Ä—ã–≤ –≤ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏,
    // —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Ä–æ–≥ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏
    val sorted = relevances.sorted()
    val maxGap = sorted.zipWithNext()
        .maxByOrNull { (a, b) -> b - a }
    return maxGap?.first ?: 0.5f
}
```

### 3. –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫

–ö–æ–º–±–∏–Ω–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ + BM25 (keyword-based):

```
–ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å = Œ± √ó cosine_similarity + (1-Œ±) √ó BM25_score
```

–ì–¥–µ `Œ±` - –≤–µ—Å–æ–≤–æ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (0.7-0.8).

### 4. –ö–æ–º–∞–Ω–¥–∞ /ragStats

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RAG:

```
/ragStats

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ RAG:
‚Ä¢ –í—Å–µ–≥–æ embeddings: 127 —á–∞–Ω–∫–æ–≤
‚Ä¢ –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞: 342 —Å–∏–º–≤–æ–ª–∞
‚Ä¢ –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤: 768
‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5):
  1. "–ö–∞–∫–∏–µ MCP —Å–µ—Ä–≤–µ—Ä—ã?" ‚Üí 3 —á–∞–Ω–∫–∞ (avg: 0.68)
  2. "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ Docker" ‚Üí 2 —á–∞–Ω–∫–∞ (avg: 0.55)
  ...
```

### 5. –ú–Ω–æ–≥–æ—Ñ–∞–π–ª–æ–≤—ã–π RAG

–ü–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ñ–∞–π–ª–∞–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

```kotlin
suspend fun findRelevantChunksMultiFile(
    question: String,
    fileNames: List<String>,
    topK: Int = 5,
    threshold: Float = 0.5f
): RagSearchResult {
    // –ü–æ–∏—Å–∫ –ø–æ –∫–∞–∂–¥–æ–º—É —Ñ–∞–π–ª—É
    // –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
}
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è RAG:
- ‚úÖ –£–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤ (–º–µ–Ω—å—à–µ —à—É–º–∞)
- ‚úÖ –£—Å–∫–æ—Ä—è–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é (–º–µ–Ω—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤)
- ‚úÖ –î–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∫–æ–Ω—Ç—Ä–æ–ª—å (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –ø–æ—Ä–æ–≥)
- ‚úÖ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∞ LLM-based reranker'–æ–º –≤ –±—É–¥—É—â–µ–º.

---

## –°—Å—ã–ª–∫–∏

- [MCP_INTEGRATION.md](MCP_INTEGRATION.md) - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ MCP —Å–µ—Ä–≤–µ—Ä–∞–º
- [CLAUDE.md](../CLAUDE.md) - –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- [RagService.kt](../src/main/kotlin/ru/dikoresearch/domain/RagService.kt) - –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ RAG —Å–µ—Ä–≤–∏—Å–∞
- [TelegramBotService.kt](../src/main/kotlin/ru/dikoresearch/infrastructure/telegram/TelegramBotService.kt) - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥

---

**–ê–≤—Ç–æ—Ä:** Claude Sonnet 4.5
**–î–∞—Ç–∞:** 04 —Ñ–µ–≤—Ä–∞–ª—è 2026
